services:
    serializer:
        class: Syncer\Serializer\Serializer
        arguments:
            - %serializer.config_dir%
            - %seriaizer.cache_dir%
        calls:
            - [setup]

    syncer.application:
        class: Symfony\Component\Console\Application
        calls:
            - [add, ['@syncer.command.sync_timings']]

    syncer.command.sync_timings:
        class: Syncer\Command\SyncTimings
        arguments:
            - '@toggl.client.toggl'
            - '@toggl.client.reports'
            - '@invoice_ninja.client'
            - '%projects%'

    toggl.guzzle.toggl:
        class: GuzzleHttp\Client
        arguments:
            - { base_uri: '%toggl.toggl_base_uri%' , debug: '%debug%'}

    toggl.guzzl.reports:
        class: GuzzleHttp\Client
        arguments:
            - { base_uri: '%toggl.reports_base_uri%', debug: '%debug%' }

    toggl.client.toggl:
        class: Syncer\Toggl\TogglClient
        arguments:
            - '@toggl.guzzle.toggl'
            - '@serializer'
            - '%toggl.api_key%'

    toggl.client.reports:
        class: Syncer\Toggl\ReportsClient
        arguments:
            - '@toggl.guzzl.reports'
            - '@serializer'
            - '%toggl.api_key%'

    invoice_ninja.guzzle:
        class: GuzzleHttp\Client
        arguments:
            - { base_uri: '%invoice_ninja.base_uri%', debug: '%debug%'}

    invoice_ninja.client:
        class: Syncer\InvoiceNinja\Client
        arguments:
            - '@invoice_ninja.guzzle'
            - '@serializer'
            - '%invoice_ninja.api_key%'
